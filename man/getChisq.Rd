% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getInference.R
\name{getChisq}
\alias{getChisq}
\title{Global chi-square tests across quantiles over time}
\usage{
getChisq(eta, differences = 0, method = "holm", alternative = "two.sided")
}
\arguments{
\item{eta}{3D numeric array \code{[iterations, m, t]} of posterior draws for
linear predictors (e.g., from \code{\link{getEta}}).}

\item{differences}{Integer \(\ge 0\). If \code{0}, test levels of
\eqn{\eta_{\cdot,i}}; if \(\ge 1\), test the \code{differences}-order
time differences of each quantile series.}

\item{method}{P-value adjustment method passed to \code{stats::p.adjust()}
(e.g., \code{"holm"}, \code{"bonferroni"}, \code{"BH"}).}

\item{alternative}{Character, one of \code{"two.sided"}, \code{"less"},
\code{"greater"}. For one-sided options, entries in the opposing direction
are truncated at 0 before forming the quadratic form.}
}
\value{
A list with components:
\describe{
  \item{\code{chisq}}{Numeric vector of length \code{t} (or \code{t - differences})
    with \eqn{\chi^2} statistics.}
  \item{\code{pvalue}}{Unadjusted p-values (vector).}
  \item{\code{adjpvalue}}{Adjusted p-values via \code{p.adjust(method)}.}
  \item{\code{differences}}{The input \code{differences}.}
}
}
\description{
Computes timewise (or difference-wise) \eqn{\chi^2_m} statistics that test
whether the vector of quantile-specific linear predictors \eqn{\eta_{\cdot,i}}
deviates from its overall mean (or from zero after differencing), using the
posterior mean vector and a pooled posterior covariance across simulations.
}
\details{
When \code{differences = 0}, the pooled covariance \eqn{\Sigma} of the
\eqn{m}-vectors \eqn{\eta_{\cdot,i}} is computed by averaging sample covariances
across time \eqn{i = 1,\dots,t}. The statistic for time \eqn{i} is
\deqn{Q_i = (\bar{\eta}_{\cdot,i} - \bar{\eta}_{\cdot,\cdot})^\top
  \Sigma^{-1} (\bar{\eta}_{\cdot,i} - \bar{\eta}_{\cdot,\cdot}),}
which is compared to \eqn{\chi^2_m}. For \code{differences > 0}, the same
is applied to the \code{differences}-order differences of \eqn{\eta}.
}
\examples{
\dontrun{
  # eta: draws x quantiles x time
  inf <- getChisq(eta, differences = 0, method = "holm")
  which(inf$adjpvalue < 0.05)
}

}
