% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getInference.R
\name{getNorm}
\alias{getNorm}
\title{Component-wise normal tests across quantiles over time}
\usage{
getNorm(eta, differences = 0, method = "holm", alternative = "two.sided")
}
\arguments{
\item{eta}{3D numeric array \code{[iterations, m, t]} of posterior draws for
linear predictors (e.g., from \code{\link{getEta}}).}

\item{differences}{Integer \(\ge 0\). If \code{0}, test levels of
\eqn{\eta_{\cdot,i}}; if \(\ge 1\), test the \code{differences}-order
time differences of each quantile series.}

\item{method}{P-value adjustment method passed to \code{stats::p.adjust()}
(e.g., \code{"holm"}, \code{"bonferroni"}, \code{"BH"}).}

\item{alternative}{Character, one of \code{"two.sided"}, \code{"less"},
\code{"greater"}. For one-sided options, entries in the opposing direction
are truncated at 0 before forming the quadratic form.}
}
\value{
A list with:
\describe{
  \item{\code{norm}}{Matrix \code{m x t} (or \code{m x (t - differences)}) of
    standardized values.}
  \item{\code{pvalue}}{Matrix of unadjusted p-values, same dimension as \code{norm}.}
  \item{\code{adjpvalue}}{Matrix of adjusted p-values.}
  \item{\code{differences}}{The input \code{differences}.}
}
}
\description{
Performs standardized component-wise tests for each quantile/time pair by
whitening the vector contrasts with the pooled covariance (via matrix square
root inverse) and converting to normal p-values, with multiple-testing
adjustment.
}
\details{
For \code{differences = 0}, let \eqn{\Sigma} be the pooled covariance across time.
Using \eqn{\Sigma^{-1/2}}, the per-time, per-quantile standardized contrasts are
\eqn{z_{q,i} = [\Sigma^{-1/2}(\bar{\eta}_{\cdot,i} - \bar{\eta}_{\cdot,\cdot})]_q}.
These \eqn{z}-scores are converted to p-values (two- or one-sided) and adjusted
with \code{p.adjust(method)}. For \code{differences > 0}, the same is applied to
the \code{differences}-order differences of \eqn{\eta}.
}
\examples{
\dontrun{
  infN <- getNorm(eta, differences = 1, method = "BH")
  which(infN$adjpvalue < 0.1, arr.ind = TRUE)
}

}
