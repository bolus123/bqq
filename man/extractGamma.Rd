% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extractEstimates.R
\name{extractGamma}
\alias{extractGamma}
\title{Posterior z-scores and normal-approx p-values for gamma}
\usage{
extractGamma(fit, side = "two.sided")
}
\arguments{
\item{fit}{A fitted \code{rstan::stanfit} from \code{\link{getModel}} (the
Stan program must include a parameter \code{gamma} with draws shaped
\code{[iterations, m, r]}).}

\item{side}{Character, one of \code{"two.sided"}, \code{"greater"},
or \code{"less"}; controls the tail for the p-value calculation.}
}
\value{
A numeric matrix of p-values with dimension \code{m x r}
  (quantiles by \code{H}-columns), matching the second and third
  dimensions of \code{gamma}.
}
\description{
Computes elementwise posterior \emph{z}-scores and corresponding
normal-approximation p-values for the grouped-\eqn{\gamma} coefficients
extracted from a \code{rstan::stanfit} object. The \emph{z}-score for each
\eqn{(q, j)} is defined as \eqn{\bar{\gamma}_{qj} / \mathrm{sd}(\gamma_{qj})}
over posterior draws.
}
\details{
This function uses \code{rstan::extract()} to get the posterior array
\code{gamma}. For each quantile index \eqn{q = 1,\dots,m} and column
\eqn{j = 1,\dots,r}, it computes
\deqn{z_{qj} = \frac{\mathrm{mean}(\gamma_{qj}^{(s)})}{\mathrm{sd}(\gamma_{qj}^{(s)})}}
and converts \eqn{z_{qj}} to a p-value using the standard normal CDF:
\itemize{
  \item \code{"two.sided"}: \eqn{2 \min\{\Phi(z), 1-\Phi(z)\}}
  \item \code{"greater"}: \eqn{1 - \Phi(z)}
  \item \code{"less"}: \eqn{\Phi(z)}
}
No multiple-testing adjustment is applied.
}
\examples{
\dontrun{
  # After fitting with getModel(...)
  pmat <- extractGamma(fit, side = "two.sided")
  image(t(pmat[nrow(pmat):1, ]))  # quick heatmap
  which(pmat < 0.05, arr.ind = TRUE)
}

}
\seealso{
\code{\link{getModel}}, \code{\link{getIsolatedShift}}, \code{\link{getSustainedShift}}
}
