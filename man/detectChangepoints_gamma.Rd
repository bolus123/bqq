% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getInference.R
\name{detectChangepoints_gamma}
\alias{detectChangepoints_gamma}
\title{Detect change points using gamma coefficients}
\usage{
detectChangepoints_gamma(
  fit_result,
  taus,
  l,
  w,
  signal_position = c("first", "last", "middle", "max_deviation"),
  y = NULL,
  eta = NULL,
  n_samples = 1000,
  alpha = 0.05,
  alternative = "two.sided",
  seed = NULL
)
}
\arguments{
\item{fit_result}{Full result from getModel()}

\item{taus}{Quantile levels}

\item{l}{Block length (for converting H-column to observation)}

\item{w}{Warm-up period}

\item{signal_position}{Method to determine signal position within a significant block:
- "first": First observation in the block (default)
- "last": Last observation in the block
- "middle": Middle observation in the block
- "max_deviation": Observation with maximum deviation from the predictive median (fitted eta at tau = 0.5)}

\item{y}{Original data (required only for signal_position = "max_deviation")}

\item{eta}{Predictive quantiles array (required only for signal_position = "max_deviation")}

\item{n_samples}{Number of samples for Laplace approximation (only used for backward
compatibility when laplace_samples not available)}

\item{alpha}{Significance level for credible interval test}

\item{alternative}{Direction of the test: "two.sided" (default), "greater", or "less".
Matches R's t.test convention. "two.sided" uses decorrelated L2-norm magnitude test.
"greater" tests H1: gamma > 0 (positive shift). "less" tests H1: gamma < 0 (negative shift).}

\item{seed}{Random seed (only used when generating new Laplace samples)}
}
\value{
List with change-point detection results
}
\description{
Uses the H-matrix gamma coefficients directly for change-point detection.
This approach is more aligned with the model design where gamma explicitly
represents shift effects at each block.
}
\details{
Automatically detects the fit_method used and extracts gamma samples accordingly:
- "mcmc" or "map_mcmc": Uses MCMC posterior draws
- "map": Uses pre-generated Laplacian approximation samples
}
\examples{
\donttest{
set.seed(123)
n <- 100
y <- rnorm(n)
taus <- c(0.25, 0.5, 0.75)
H <- getIsolatedShift(n, l = 20, w = 20)
fit <- getModel(y, taus, H = H, w = 20, fit_method = "map",
                map_hessian = FALSE, map_iter = 500)
result <- detectChangepoints_gamma(fit, taus = taus, l = 20, w = 20)
}
}
