% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getInference.R
\name{getChisq_BQQ}
\alias{getChisq_BQQ}
\title{Compute BQQ chi-squared statistic for quantile vectors}
\usage{
getChisq_BQQ(
  eta,
  w = 0,
  use_differencing = FALSE,
  df_method = "reduced",
  p_method = "empirical_null",
  n_bootstrap = 1000,
  alpha = 0.05,
  adjust_method = "holm",
  signal_position = c("first", "last", "middle", "max_deviation"),
  y = NULL,
  taus = NULL
)
}
\arguments{
\item{eta}{3D array [iterations, quantiles, time] from getEta()}

\item{w}{Warm-up period to exclude from testing and use for null calibration}

\item{use_differencing}{If TRUE, use first-order differencing (for sustained shifts)}

\item{df_method}{Method for degrees of freedom: "full" (m) or "reduced" (m-1)}

\item{p_method}{Method for p-values: "chisq", "bootstrap", or "empirical_null"}

\item{n_bootstrap}{Number of bootstrap replicates (if p_method = "bootstrap")}

\item{alpha}{Significance level for multiple testing adjustment}

\item{adjust_method}{P-value adjustment method (e.g., "holm", "BH", "bonferroni")}

\item{signal_position}{Method to determine signal position within a run of consecutive signals:
- "first": First observation in the run (default)
- "last": Last observation in the run
- "middle": Middle observation in the run
- "max_deviation": Observation with maximum deviation from the predictive median (fitted eta at tau = 0.5)}

\item{y}{Original data (required only for signal_position = "max_deviation")}

\item{taus}{Quantile levels (required only for signal_position = "max_deviation")}
}
\value{
List with chi-squared statistics, p-values, and diagnostic info
}
\description{
Implements the chi-squared-inspired charting statistic from the BQQ methodology:
\eqn{W_t = Z_t' S^{-1} Z_t}
where Z_t = mean(Z_tr) across posterior draws r.
}
\details{
The covariance S is estimated from the warm-up period to reflect the natural
variability under the null hypothesis (no change point). This captures both:
1. Posterior uncertainty in parameter estimates
2. Natural temporal variability from the random walk component
}
\examples{
\donttest{
set.seed(123)
n <- 100
y <- rnorm(n)
taus <- c(0.25, 0.5, 0.75)
H <- getIsolatedShift(n, l = 20, w = 20)
fit <- getModel(y, taus, H = H, w = 20, fit_method = "map",
                map_hessian = FALSE, map_iter = 500)
eta <- getEta(fit, H = H)
result <- getChisq_BQQ(eta, w = 20)
}
}
